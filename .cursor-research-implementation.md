# Cursor Agent Implementation Prompt - Deep Research Integration

## üéØ **Mission**
You are receiving comprehensive research findings for a Next.js 15.3.2 + Vercel AI SDK v5 + better-auth + Drizzle ORM application. Your task is to **implement the research-backed solutions** to resolve deployment blockers and optimize the codebase.

## üìã **Context**
- **Repository**: `andrew-freeland/estimator` (forked from `cgoinglove/better-chatbot`)
- **Current Status**: Build passes locally but has deployment issues on Vercel
- **Stack**: Next.js 15.3.2, AI SDK v5.0.60, better-auth 1.3.27, Drizzle ORM 0.41.0, Tailwind v4
- **Target**: Production-ready Vercel deployment

## üîç **Research Areas to Implement**

### **1. Next.js 15.3.2 + Vercel Deployment**
**Expected Research Output**: Latest deployment patterns, Edge vs Node runtime configuration, build optimization
**Implementation Tasks**:
- [ ] Apply recommended runtime configurations for API routes
- [ ] Optimize build process and memory usage
- [ ] Configure proper Edge vs Node runtime usage
- [ ] Implement deployment best practices

### **2. Vercel AI SDK v5.0.60 Integration**
**Expected Research Output**: Model object requirements, streaming patterns, provider compatibility
**Implementation Tasks**:
- [ ] Verify all LanguageModel objects are properly configured
- [ ] Ensure correct streaming response methods are used
- [ ] Optimize multi-provider setup (OpenAI, Anthropic, Google, XAI, Groq, OpenRouter)
- [ ] Implement proper tool calling patterns

### **3. better-auth 1.3.27 + Next.js 15 Compatibility**
**Expected Research Output**: Authentication setup, Edge runtime issues, OAuth integration
**Implementation Tasks**:
- [ ] Fix any remaining Edge runtime incompatibilities
- [ ] Optimize OAuth provider configuration
- [ ] Implement session management best practices
- [ ] Configure middleware properly

### **4. Drizzle ORM 0.41.0 + PostgreSQL + pgvector**
**Expected Research Output**: Type safety, conditional queries, vector operations
**Implementation Tasks**:
- [ ] Replace temporary type assertions with proper query patterns
- [ ] Implement proper conditional query building
- [ ] Optimize pgvector integration
- [ ] Configure connection pooling

### **5. Google Cloud Platform Integration**
**Expected Research Output**: GCS, Cloud SQL, OAuth, API quotas
**Implementation Tasks**:
- [ ] Optimize GCS signed URL generation
- [ ] Configure Cloud SQL connection management
- [ ] Implement proper Google Workspace API integration
- [ ] Add rate limiting and error handling

### **6. Multi-Provider AI Model Management**
**Expected Research Output**: Provider switching, API key management, model compatibility
**Implementation Tasks**:
- [ ] Implement proper model capability detection
- [ ] Optimize API key validation and fallback strategies
- [ ] Add cost optimization features
- [ ] Implement proper rate limiting

### **7. SWR 2.3.6 + TypeScript Integration**
**Expected Research Output**: Type safety, key/fetcher patterns, caching strategies
**Implementation Tasks**:
- [ ] Ensure all SWR usage is properly typed
- [ ] Implement optimal caching strategies
- [ ] Add proper error handling and retry logic
- [ ] Optimize data fetching patterns

### **8. Tailwind CSS v4 + Next.js 15**
**Expected Research Output**: Configuration, build process, compatibility
**Implementation Tasks**:
- [ ] Verify Tailwind v4 configuration is optimal
- [ ] Optimize PostCSS setup
- [ ] Implement theme system best practices
- [ ] Add performance optimizations

## üöÄ **Implementation Guidelines**

### **Priority Order**
1. **Critical Blockers**: Edge runtime, Drizzle ORM, AI SDK model objects
2. **Deployment Issues**: Build optimization, memory management
3. **Performance**: Caching, API optimization, connection pooling
4. **Enhancement**: Advanced features, monitoring, analytics

### **Code Standards**
- ‚úÖ **Preserve existing functionality** - no breaking changes
- ‚úÖ **Add inline comments** for all changes: `// Research-backed fix`
- ‚úÖ **Use `@/` import aliases** consistently
- ‚úÖ **Follow TypeScript best practices**
- ‚úÖ **Test each change** with `pnpm build`

### **File Modification Strategy**
- **Start with critical files**: API routes, database queries, AI SDK usage
- **Test incrementally**: Make one change, test, commit
- **Document changes**: Add comments explaining research-backed decisions
- **Preserve business logic**: Don't change prompts, agent behavior, or core functionality

## üìä **Expected Research Data Format**

For each research area, you should receive:

```markdown
## [Technology Name] - Research Results

### Current Status (2024/2025)
- Latest version compatibility
- Known issues and solutions
- Best practices

### Implementation Examples
```typescript
// Working code examples
```

### Common Issues & Solutions
- Issue: Description
- Solution: Step-by-step fix

### Configuration Templates
```typescript
// Ready-to-use configs
```

### Troubleshooting Checklist
- [ ] Step 1
- [ ] Step 2
- [ ] Step 3
```

## üéØ **Success Criteria**

**Phase 1 - Critical Fixes**:
- [ ] All TypeScript compilation errors resolved
- [ ] Vercel deployment succeeds without warnings
- [ ] Edge runtime issues eliminated
- [ ] AI SDK model objects properly configured

**Phase 2 - Optimization**:
- [ ] Build time optimized (< 2 minutes)
- [ ] Memory usage optimized
- [ ] Database queries optimized
- [ ] API response times improved

**Phase 3 - Production Ready**:
- [ ] Error handling comprehensive
- [ ] Monitoring and logging implemented
- [ ] Performance metrics tracked
- [ ] Documentation updated

## üîß **Implementation Commands**

```bash
# Test each change
pnpm build
pnpm typecheck
pnpm lint

# Commit incrementally
git add .
git commit -m "research: implement [specific fix] from deep research"
git push origin main
```

## üìù **Documentation Requirements**

For each implemented fix:
1. **Add inline comments** explaining the research-backed decision
2. **Update relevant documentation** if needed
3. **Add to changelog** with research source attribution
4. **Test thoroughly** before marking complete

## üö® **Critical Notes**

- **DO NOT** modify business logic, prompts, or agent behavior
- **DO NOT** change folder structure or export names
- **DO NOT** add new dependencies without justification
- **DO** implement research findings systematically
- **DO** test each change thoroughly
- **DO** document all research-backed decisions

## üìû **Research Source Attribution**

When implementing fixes, include attribution:
```typescript
// Research-backed fix: [Technology] - [Source/Date]
// Based on: [Research finding summary]
```

---

**Ready to receive research findings and begin systematic implementation!**
